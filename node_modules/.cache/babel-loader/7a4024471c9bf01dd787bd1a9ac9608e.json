{"ast":null,"code":"import _slicedToArray from\"C:/Users/panyushin/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import'./Profile.css';import Header from'../Header/Header';import useFormWithValidation from'../../hooks/useFormWithValidation';import{CurrentUserContext}from'../../contexts/CurrentUserContext';import Preloader from'../Preloader/Preloader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Profile(props){var currentUser=React.useContext(CurrentUserContext);var _React$useState=React.useState(true),_React$useState2=_slicedToArray(_React$useState,2),edit=_React$useState2[0],setEdit=_React$useState2[1];var _useFormWithValidatio=useFormWithValidation(),values=_useFormWithValidatio.values,handleChange=_useFormWithValidatio.handleChange,resetForm=_useFormWithValidatio.resetForm,errors=_useFormWithValidatio.errors,isValid=_useFormWithValidatio.isValid,setValues=_useFormWithValidatio.setValues;var name=values.name,email=values.email;var lastName=currentUser.name;var lastEmail=currentUser.email;var _React$useState3=React.useState(true),_React$useState4=_slicedToArray(_React$useState3,2),disabled=_React$useState4[0],setDisabled=_React$useState4[1];function handleEdit(){setEdit(false);}React.useEffect(function(){if(name!==lastName||email!==lastEmail){setDisabled(false);}else setDisabled(true);},[name,email]);React.useEffect(function(){setValues({name:currentUser.name,email:currentUser.email});},[currentUser]);function handleSubmit(e){e.preventDefault();isValid&&props.handleEditProfile({name:name,email:email},function(){resetForm();});setEdit(true);}function handleLogout(){props.logout({email:currentUser.email});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{loggedIn:true}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"profile__title\",children:[\"\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \",currentUser.name,\"!\"]}),props.isLoading?/*#__PURE__*/_jsx(Preloader,{}):/*#__PURE__*/_jsxs(\"form\",{className:\"profile__form\",noValidate:true,action:\"URL\",method:\"post\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__container-input\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"profile__label\",children:[\"\\u0418\\u043C\\u044F\",/*#__PURE__*/_jsx(\"input\",{className:\"profile__input\",type:\"text\",name:\"name\",id:\"name\",required:true,minLength:\"2\",maxLength:\"30\",disabled:edit,onChange:handleChange,value:name||'',pattern:\"^[\\u0430-\\u044F\\u0410-\\u042F\\u0451\\u0401a-zA-Z]{2,30}$\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"profile__input-error\",children:errors.name}),/*#__PURE__*/_jsxs(\"label\",{className:\"profile__label\",children:[\"E-mail\",/*#__PURE__*/_jsx(\"input\",{className:\"profile__input\",type:\"email\",name:\"email\",id:\"email\",required:true,pattern:\"^([^\\\\x00-\\\\x20\\\\x22\\\\x28\\\\x29\\\\x2c\\\\x2e\\\\x3a-\\\\x3c\\\\x3e\\\\x40\\\\x5b-\\\\x5d\\\\x7f-\\\\xff]+|\\\\x22([^\\\\x0d\\\\x22\\\\x5c\\\\x80-\\\\xff]|\\\\x5c[\\\\x00-\\\\x7f])*\\\\x22)(\\\\x2e([^\\\\x00-\\\\x20\\\\x22\\\\x28\\\\x29\\\\x2c\\\\x2e\\\\x3a-\\\\x3c\\\\x3e\\\\x40\\\\x5b-\\\\x5d\\\\x7f-\\\\xff]+|\\\\x22([^\\\\x0d\\\\x22\\\\x5c\\\\x80-\\\\xff]|\\\\x5c[\\\\x00-\\\\x7f])*\\\\x22))*\\\\x40([^\\\\x00-\\\\x20\\\\x22\\\\x28\\\\x29\\\\x2c\\\\x2e\\\\x3a-\\\\x3c\\\\x3e\\\\x40\\\\x5b-\\\\x5d\\\\x7f-\\\\xff]+|\\\\x5b([^\\\\x0d\\\\x5b-\\\\x5d\\\\x80-\\\\xff]|\\\\x5c[\\\\x00-\\\\x7f])*\\\\x5d)(\\\\x2e([^\\\\x00-\\\\x20\\\\x22\\\\x28\\\\x29\\\\x2c\\\\x2e\\\\x3a-\\\\x3c\\\\x3e\\\\x40\\\\x5b-\\\\x5d\\\\x7f-\\\\xff]+|\\\\x5b([^\\\\x0d\\\\x5b-\\\\x5d\\\\x80-\\\\xff]|\\\\x5c[\\\\x00-\\\\x7f])*\\\\x5d))*(\\\\.\\\\w{2,})+$\",disabled:edit,onChange:handleChange,value:email||''})]}),/*#__PURE__*/_jsx(\"span\",{className:\"profile__input-error\",children:errors.email})]}),edit?/*#__PURE__*/_jsxs(\"ul\",{className:\"profile__buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile__edit-button\",type:\"button\",onClick:handleEdit,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"profile__signout-button\",type:\"button\",onClick:handleLogout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438 \\u0438\\u0437 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\\u0430\"})]}):/*#__PURE__*/_jsx(\"button\",{className:isValid&&!disabled?'profile__submit-button':'profile__submit-button profile__submit-button_disabled',disabled:!isValid||disabled,type:\"submit\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]})]});}","map":{"version":3,"names":["React","Header","useFormWithValidation","CurrentUserContext","Preloader","Profile","props","currentUser","useContext","useState","edit","setEdit","values","handleChange","resetForm","errors","isValid","setValues","name","email","lastName","lastEmail","disabled","setDisabled","handleEdit","useEffect","handleSubmit","e","preventDefault","handleEditProfile","handleLogout","logout","isLoading"],"sources":["C:/Users/panyushin/dev/movies-explorer-frontend/src/components/Profile/Profile.js"],"sourcesContent":["import React from 'react';\nimport './Profile.css';\nimport Header from '../Header/Header';\nimport useFormWithValidation from '../../hooks/useFormWithValidation';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\nimport Preloader from '../Preloader/Preloader';\n\nexport default function Profile(props) {\n  const currentUser = React.useContext(CurrentUserContext);\n\n  const [edit, setEdit] = React.useState(true);\n  const { values, handleChange, resetForm, errors, isValid, setValues } = useFormWithValidation();\n  const { name, email } = values;\n  const lastName = currentUser.name\n  const lastEmail = currentUser.email\n  const [disabled, setDisabled] = React.useState(true);\n\n  function handleEdit() {\n    setEdit(false);\n  }\n\n\n  React.useEffect(() => {\n    if(name !== lastName || email !== lastEmail) {\n      setDisabled(false)\n    } else (\n      setDisabled(true)\n    )\n  }, [name, email])\n\n  React.useEffect(() => {\n    setValues({name: currentUser.name, email: currentUser.email})\n  }, [currentUser])\n\n  function handleSubmit(e) {\n    e.preventDefault();\n\n    isValid && props.handleEditProfile({\n      name: name,\n      email: email,\n    }, () => { resetForm() });\n    setEdit(true);\n  }\n\n  function handleLogout() {\n    props.logout({ email: currentUser.email })\n  }\n\n  return(\n    <>\n      <Header loggedIn={true} />\n      <section className='profile'>\n        <h2 className='profile__title'>Привет, {currentUser.name}!</h2>\n        {props.isLoading\n          ? <Preloader />\n\n          : <form className='profile__form'\n            noValidate\n            action='URL'\n            method='post'\n            onSubmit={handleSubmit}\n          >\n            <div className='profile__container-input'>\n              <label className='profile__label'>\n                Имя\n                <input\n                  className='profile__input'\n                  type='text'\n                  name='name'\n                  id='name'\n                  required\n                  minLength='2'\n                  maxLength='30'\n                  disabled={edit}\n                  onChange={handleChange}\n                  value={name || ''}\n                  pattern='^[а-яА-ЯёЁa-zA-Z]{2,30}$'\n                />\n              </label>\n              <span className='profile__input-error'>{errors.name}</span>\n              <label className='profile__label'>\n                E-mail\n                <input\n                  className='profile__input'\n                  type='email'\n                  name='email'\n                  id='email'\n                  required\n                  pattern='^([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22))*\\x40([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d))*(\\.\\w{2,})+$'\n                  disabled={edit}\n                  onChange={handleChange}\n                  value={email || ''}\n                />\n              </label>\n              <span className='profile__input-error'>{errors.email}</span>\n            </div>\n            {\n              edit\n                ? <ul className='profile__buttons'>\n                    <button className='profile__edit-button' type='button' onClick={handleEdit}>Редактировать</button>\n                    <button className='profile__signout-button' type='button' onClick={handleLogout}>Выйти из аккаунта</button>\n                  </ul>\n\n                : <button className={ isValid && !disabled ? 'profile__submit-button' : 'profile__submit-button profile__submit-button_disabled'} disabled={!isValid || disabled} type='submit'>Сохранить</button>\n            }\n          </form>\n        }\n      </section>\n    </>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}